(function(){"use strict";var e={1831:function(e,t,i){var r=i(5471),s=i(8505),o=i(1689),l=i(9456),a=i(5486),n=function(){var e=this,t=e._self._c;return t(s.A,[t(a.A,{staticClass:"pa-4"},[e.isStudentStorageFormVisible?t("createOrder",{attrs:{lead:e.leadData,universities:e.universities,"send-billing":e.sendBilling},on:{"update:sendBilling":function(t){e.sendBilling=t},"update:send-billing":function(t){e.sendBilling=t},submit:e.createOrderHandleSubmit}}):e._e(),e.isMBRFormVisible?t("createOrderMBO",{attrs:{lead:e.leadData,"send-billing":e.sendBilling},on:{"update:sendBilling":function(t){e.sendBilling=t},"update:send-billing":function(t){e.sendBilling=t},submit:e.createOrderHandleSubmit}}):e._e(),e.orderCreated?t(o.A,{staticClass:"pa-6 text-center",attrs:{elevation:"3"}},[t(l.A,{staticClass:"mb-3",attrs:{color:"success",size:"56"}},[e._v(" mdi-check-circle ")]),t("h3",{staticClass:"mb-2"},[e._v("Order Created!")]),t("p",{staticClass:"mb-6"},[e._v("Opening order...")])],1):e._e(),!e.leadLoaded||e.orderCreated||e.isSupportedLeadType?e._e():t(o.A,{staticClass:"pa-6 text-center",attrs:{elevation:"3"}},[t(l.A,{staticClass:"mb-3",attrs:{color:"warning",size:"48"}},[e._v(" mdi-alert-circle ")]),t("h3",[e._v("Unsupported Lead Type")]),t("p",[e._v(" Lead Type "),t("strong",[e._v(e._s(e.leadType))]),e._v(" is not supported. ")])],1)],1)],1)},d=[],c=(i(8111),i(1701),i(3110),i(8335),i(6521)),u=i(8834),m=i(7155),f=i(1526),_=i(1770),p=i(8230),b=i(8412),h=i(5786),v=i(9940),g=function(){var e=this,t=e._self._c;return t(o.A,{staticClass:"pa-6 mx-auto",attrs:{elevation:"4","max-width":"1100"}},[t(u.ZR,[e._v(" Review and confirm Lead and Storage details before creating the Order ")]),t(_.A,{staticClass:"mb-6"}),t(p.A,{ref:"form",on:{submit:function(t){return t.preventDefault(),e.createOrderHandleSubmit.apply(null,arguments)}}},[t(b.A,{attrs:{dense:""}},[t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title"},[e._v("Lead Information")])]),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"First Name",outlined:"",dense:""},model:{value:e.form.First_Name,callback:function(t){e.$set(e.form,"First_Name",t)},expression:"form.First_Name"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Last Name",outlined:"",dense:""},model:{value:e.form.Last_Name,callback:function(t){e.$set(e.form,"Last_Name",t)},expression:"form.Last_Name"}})],1),t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{label:"Phone",outlined:"",dense:""},model:{value:e.form.Phone,callback:function(t){e.$set(e.form,"Phone",t)},expression:"form.Phone"}})],1),t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{label:"Email",outlined:"",dense:""},model:{value:e.form.Email,callback:function(t){e.$set(e.form,"Email",t)},expression:"form.Email"}})],1),t(f.A,{attrs:{cols:"12"}},[t(h.A,{attrs:{label:"University",items:e.universities,"item-text":"label","item-value":"value",outlined:"",dense:""},model:{value:e.form.Lead_University,callback:function(t){e.$set(e.form,"Lead_University",t)},expression:"form.Lead_University"}})],1),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Move Out Details")])]),t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{type:"date",label:"Move Out Date",outlined:"",dense:""},model:{value:e.form.Move_Out_Date,callback:function(t){e.$set(e.form,"Move_Out_Date",t)},expression:"form.Move_Out_Date"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Move Out Address",outlined:"",dense:""},model:{value:e.form.Move_Out_Address,callback:function(t){e.$set(e.form,"Move_Out_Address",t)},expression:"form.Move_Out_Address"}})],1),t(f.A,{attrs:{cols:"6",md:"4"}},[t(v.A,{attrs:{label:"Move Out City",outlined:"",dense:""},model:{value:e.form.Move_Out_City,callback:function(t){e.$set(e.form,"Move_Out_City",t)},expression:"form.Move_Out_City"}})],1),t(f.A,{attrs:{cols:"6",md:"4"}},[t(v.A,{attrs:{label:"Move Out State",outlined:"",dense:""},model:{value:e.form.Move_Out_State,callback:function(t){e.$set(e.form,"Move_Out_State",t)},expression:"form.Move_Out_State"}})],1),t(f.A,{attrs:{cols:"6",md:"4"}},[t(v.A,{attrs:{label:"Move Out ZIP",outlined:"",dense:""},model:{value:e.form.Move_Out_Zip,callback:function(t){e.$set(e.form,"Move_Out_Zip",t)},expression:"form.Move_Out_Zip"}})],1),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Storage Items")])]),t(f.A,{attrs:{cols:"12",md:"4"}},[t(v.A,{attrs:{type:"number",label:"Number of Bins",outlined:"",dense:""},model:{value:e.form.No_of_Bins,callback:function(t){e.$set(e.form,"No_of_Bins",e._n(t))},expression:"form.No_of_Bins"}})],1),t(f.A,{attrs:{cols:"12",md:"4"}},[t(v.A,{attrs:{type:"number",label:"Loose Items",outlined:"",dense:""},model:{value:e.form.No_of_Loose_Items,callback:function(t){e.$set(e.form,"No_of_Loose_Items",e._n(t))},expression:"form.No_of_Loose_Items"}})],1),t(f.A,{attrs:{cols:"12",md:"4"}},[t(v.A,{attrs:{label:"Total Items",value:e.totalItems,readonly:"",outlined:"",dense:""}})],1),e.form.No_of_Bins>0?[t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Empty Bin Drop-Off")])]),t(f.A,{attrs:{cols:"12"}},[t(m.A,{attrs:{label:"Skip Empty Bin Drop-Off Details"},model:{value:e.skipEmptyBinDropOff,callback:function(t){e.skipEmptyBinDropOff=t},expression:"skipEmptyBinDropOff"}})],1),e.skipEmptyBinDropOff?e._e():[t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{type:"date",label:"Bin Drop-Off Date",rules:[e.requiredRule],outlined:"",dense:""},model:{value:e.form.Empty_Bin_Drop_Off_Date,callback:function(t){e.$set(e.form,"Empty_Bin_Drop_Off_Date",t)},expression:"form.Empty_Bin_Drop_Off_Date"}})],1),t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{label:"Bin Drop-Off Address",rules:[e.requiredRule],outlined:"",dense:""},model:{value:e.form.Empty_Bin_Drop_Off_Address,callback:function(t){e.$set(e.form,"Empty_Bin_Drop_Off_Address",t)},expression:"form.Empty_Bin_Drop_Off_Address"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"City",rules:[e.requiredRule],outlined:"",dense:""},model:{value:e.form.Empty_Bin_Drop_Off_City,callback:function(t){e.$set(e.form,"Empty_Bin_Drop_Off_City",t)},expression:"form.Empty_Bin_Drop_Off_City"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"State",rules:[e.requiredRule],outlined:"",dense:""},model:{value:e.form.Empty_Bin_Drop_Off_State,callback:function(t){e.$set(e.form,"Empty_Bin_Drop_Off_State",t)},expression:"form.Empty_Bin_Drop_Off_State"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"ZIP",rules:[e.requiredRule],outlined:"",dense:""},model:{value:e.form.Empty_Bin_Drop_Off_Zip,callback:function(t){e.$set(e.form,"Empty_Bin_Drop_Off_Zip",t)},expression:"form.Empty_Bin_Drop_Off_Zip"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Time Window",rules:[e.requiredRule],outlined:"",dense:""},model:{value:e.form.Empty_Bin_Drop_Off_Time_Window,callback:function(t){e.$set(e.form,"Empty_Bin_Drop_Off_Time_Window",t)},expression:"form.Empty_Bin_Drop_Off_Time_Window"}})],1)]]:e._e(),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Pricing")])]),t(f.A,{attrs:{cols:"12",md:"4"}},[t(m.A,{attrs:{label:"Custom Pricing"},model:{value:e.form.Custom_Pricing,callback:function(t){e.$set(e.form,"Custom_Pricing",t)},expression:"form.Custom_Pricing"}})],1),e.form.Custom_Pricing?t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{type:"number",label:"Price per Item",outlined:"",dense:""},on:{input:function(t){e.lastEditedPricingField="pricePerItem"}},model:{value:e.pricePerItem,callback:function(t){e.pricePerItem=e._n(t)},expression:"pricePerItem"}})],1):e._e(),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{type:"number",label:"Estimated Total Price","error-messages":e.pricingError,outlined:"",dense:""},on:{input:function(t){e.lastEditedPricingField="estimatedTotalPrice"}},model:{value:e.estimatedTotalPrice,callback:function(t){e.estimatedTotalPrice=e._n(t)},expression:"estimatedTotalPrice"}})],1),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Billing")])]),t(f.A,{attrs:{cols:"12",md:"6"}},[t(h.A,{attrs:{label:"Send Billing *",items:["Yes","No","Select"],rules:[e.requiredRule],outlined:"",dense:""},model:{value:e.sendBillingLocal,callback:function(t){e.sendBillingLocal=t},expression:"sendBillingLocal"}})],1)],2),t(_.A,{staticClass:"my-6"}),t(c.A,{attrs:{color:"primary",block:"",large:"",type:"submit"}},[e._v(" Convert to Order ")])],1)],1)},y=[],A={name:"CreateOrder",props:{lead:{type:Object,required:!0},sendBilling:{type:String,default:"Select"},universities:{type:Array,default:()=>[]}},data(){return{form:{...this.lead,Empty_Bin_Drop_Off_Date:"",Empty_Bin_Drop_Off_Address:"",Empty_Bin_Drop_Off_City:"",Empty_Bin_Drop_Off_State:"",Empty_Bin_Drop_Off_Zip:"",Empty_Bin_Drop_Off_Time_Window:""},sendBillingLocal:this.sendBilling,pricePerItem:null,estimatedTotalPrice:0,lastEditedPricingField:null,pricingError:null,skipEmptyBinDropOff:!1}},computed:{totalItems(){return Number(this.form.No_of_Bins||0)+Number(this.form.No_of_Loose_Items||0)}},watch:{sendBillingLocal(e){this.$emit("update:sendBilling",e)},totalItems(){this.form.Custom_Pricing?this.handleCustomPricing():this.calculatePricing()},"form.Custom_Pricing"(e){this.pricingError=null,this.lastEditedPricingField=null,!1===e?this.calculatePricing():(this.lastEditedPricingField="pricePerItem",this.handleCustomPricing())},pricePerItem(){this.form.Custom_Pricing&&"pricePerItem"===this.lastEditedPricingField&&this.handleCustomPricing()},estimatedTotalPrice(){this.form.Custom_Pricing&&"estimatedTotalPrice"===this.lastEditedPricingField&&this.handleCustomPricing()},skipEmptyBinDropOff(e){e&&this.clearEmptyBinDropOffFields()}},methods:{requiredRule(e){return!!e||"Required"},roundCurrency(e){return Number(parseFloat(e).toFixed(2))},pricingTable(e){return e<=2?22.5:e<=5?20:e<=10?18:15},handleCustomPricing(){this.totalItems<=0?this.pricingError="Total Item Count must be greater than 0":(this.pricingError=null,"pricePerItem"===this.lastEditedPricingField&&(this.estimatedTotalPrice=this.roundCurrency(this.pricePerItem*this.totalItems)),"estimatedTotalPrice"===this.lastEditedPricingField&&(this.pricePerItem=this.roundCurrency(this.estimatedTotalPrice/this.totalItems)))},calculatePricing(){const e=this.pricingTable(this.totalItems);this.pricePerItem=e,this.estimatedTotalPrice=this.roundCurrency(e*this.totalItems)},clearEmptyBinDropOffFields(){this.form.Empty_Bin_Drop_Off_Date="",this.form.Empty_Bin_Drop_Off_Address="",this.form.Empty_Bin_Drop_Off_City="",this.form.Empty_Bin_Drop_Off_State="",this.form.Empty_Bin_Drop_Off_Zip=""},createOrderHandleSubmit(){if(!this.$refs.form.validate())return;const e={...this.form,Total_Item_Count:this.totalItems,Price_per_Item:this.pricePerItem||0,Estimated_Price:this.estimatedTotalPrice||0,Custom_Pricing:this.form.Custom_Pricing,skipEmptyBinDropOff:this.skipEmptyBinDropOff};this.skipEmptyBinDropOff&&(delete e.Empty_Bin_Drop_Off_Date,delete e.Empty_Bin_Drop_Off_Address,delete e.Empty_Bin_Drop_Off_City,delete e.Empty_Bin_Drop_Off_State,delete e.Empty_Bin_Drop_Off_Zip,delete e.Empty_Bin_Drop_Off_Time_Window),this.$emit("submit",e)}}},O=A,B=i(1656),C=(0,B.A)(O,g,y,!1,null,"2c22ce52",null),D=C.exports,P=function(){var e=this,t=e._self._c;return t(o.A,{staticClass:"pa-6 mx-auto",attrs:{elevation:"4","max-width":"1100"}},[t(u.ZR,[e._v(" Review and confirm Moving Box Rental details before creating the Order ")]),t(_.A,{staticClass:"mb-6"}),t(p.A,{ref:"form",on:{submit:function(t){return t.preventDefault(),e.handleSubmit.apply(null,arguments)}},model:{value:e.isValid,callback:function(t){e.isValid=t},expression:"isValid"}},[t(b.A,{attrs:{dense:""}},[t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title"},[e._v("Lead Information")])]),t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{label:"First Name",outlined:"",dense:""},model:{value:e.form.First_Name,callback:function(t){e.$set(e.form,"First_Name",t)},expression:"form.First_Name"}})],1),t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{label:"Last Name *",outlined:"",dense:"",rules:[e=>!!e||"Last name is required"],required:""},model:{value:e.form.Last_Name,callback:function(t){e.$set(e.form,"Last_Name",t)},expression:"form.Last_Name"}})],1),t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{label:"Phone",outlined:"",dense:""},model:{value:e.form.Phone,callback:function(t){e.$set(e.form,"Phone",t)},expression:"form.Phone"}})],1),t(f.A,{attrs:{cols:"12",md:"6"}},[t(v.A,{attrs:{label:"Email",outlined:"",dense:""},model:{value:e.form.Email,callback:function(t){e.$set(e.form,"Email",t)},expression:"form.Email"}})],1),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Address")])]),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"sub-section-title mt-2 mb-3"},[e._v("Delivery")])]),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Delivery Address",outlined:"",dense:""},model:{value:e.form.Delivery_Address,callback:function(t){e.$set(e.form,"Delivery_Address",t)},expression:"form.Delivery_Address"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Delivery City",outlined:"",dense:""},model:{value:e.form.Delivery_City,callback:function(t){e.$set(e.form,"Delivery_City",t)},expression:"form.Delivery_City"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Delivery State",outlined:"",dense:""},model:{value:e.form.Delivery_State,callback:function(t){e.$set(e.form,"Delivery_State",t)},expression:"form.Delivery_State"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Delivery Zip",outlined:"",dense:""},model:{value:e.form.Delivery_Zip,callback:function(t){e.$set(e.form,"Delivery_Zip",t)},expression:"form.Delivery_Zip"}})],1),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"sub-section-title mt-2 mb-3"},[e._v("Pickup")])]),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Pickup Address",outlined:"",dense:""},model:{value:e.form.Pickup_Address,callback:function(t){e.$set(e.form,"Pickup_Address",t)},expression:"form.Pickup_Address"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Pickup City",outlined:"",dense:""},model:{value:e.form.Pickup_City,callback:function(t){e.$set(e.form,"Pickup_City",t)},expression:"form.Pickup_City"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Pickup State",outlined:"",dense:""},model:{value:e.form.Pickup_State,callback:function(t){e.$set(e.form,"Pickup_State",t)},expression:"form.Pickup_State"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Pickup Zip",outlined:"",dense:""},model:{value:e.form.Pickup_Zip,callback:function(t){e.$set(e.form,"Pickup_Zip",t)},expression:"form.Pickup_Zip"}})],1),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Rental Details")])]),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{type:"date",label:"Rental Start Date",outlined:"",dense:""},model:{value:e.form.Rental_Start_Date,callback:function(t){e.$set(e.form,"Rental_Start_Date",t)},expression:"form.Rental_Start_Date"}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{type:"date",label:"Rental End Date",outlined:"",dense:""},model:{value:e.form.Rental_End_Date,callback:function(t){e.$set(e.form,"Rental_End_Date",t)},expression:"form.Rental_End_Date"}})],1),t(f.A,{attrs:{cols:"4"}},[t(v.A,{attrs:{type:"number",label:"Bedrooms Count",outlined:"",dense:"",min:"1"},model:{value:e.form.Bedrooms_Count,callback:function(t){e.$set(e.form,"Bedrooms_Count",e._n(t))},expression:"form.Bedrooms_Count"}})],1),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Options")])]),t(f.A,{attrs:{cols:"4"}},[t(m.A,{attrs:{label:"Free Dolly Rental"},model:{value:e.form.Free_Rental,callback:function(t){e.$set(e.form,"Free_Rental",t)},expression:"form.Free_Rental"}})],1),t(f.A,{attrs:{cols:"4"}},[t(m.A,{attrs:{label:"Include Bubble Wrap (+$60)"},model:{value:e.form.Include_Bubble_Wrap,callback:function(t){e.$set(e.form,"Include_Bubble_Wrap",t)},expression:"form.Include_Bubble_Wrap"}})],1),t(f.A,{attrs:{cols:"4"}},[t(m.A,{attrs:{label:"Custom Pricing"},model:{value:e.form.Custom_Pricing,callback:function(t){e.$set(e.form,"Custom_Pricing",t)},expression:"form.Custom_Pricing"}})],1),t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Pricing")])]),e.form.Custom_Pricing?[t(f.A,{attrs:{cols:"3"}},[t(v.A,{attrs:{label:"Order Custom Subtotal",type:"number",outlined:"",dense:""},model:{value:e.form.Order_Subtotal,callback:function(t){e.$set(e.form,"Order_Subtotal",e._n(t))},expression:"form.Order_Subtotal"}})],1),t(f.A,{attrs:{cols:"3"}},[t(v.A,{attrs:{label:"Bubble Wrap",value:e.form.Include_Bubble_Wrap?60:0,outlined:"",dense:"",readonly:""}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Final Order Total",value:`$${e.customOrderTotal}`,outlined:"",dense:"",readonly:""}})],1)]:[t(f.A,{attrs:{cols:"3"}},[t(v.A,{attrs:{label:"Total Boxes",value:e.totalBoxCount,outlined:"",dense:"",readonly:""}})],1),t(f.A,{attrs:{cols:"3"}},[t(v.A,{attrs:{label:"Weeks",value:e.weeks,outlined:"",dense:"",readonly:""}})],1),t(f.A,{attrs:{cols:"3"}},[t(v.A,{attrs:{label:"Box Tier",value:e.boxTier,outlined:"",dense:"",readonly:""}})],1),t(f.A,{attrs:{cols:"3"}},[t(v.A,{attrs:{label:"Discount",value:e.discountLabel,outlined:"",dense:"",readonly:""}})],1),t(f.A,{attrs:{cols:"6"}},[t(v.A,{attrs:{label:"Final Order Total",value:`$${e.orderTotal}`,outlined:"",dense:"",readonly:""}})],1)],t(f.A,{attrs:{cols:"12"}},[t("div",{staticClass:"section-title mt-6"},[e._v("Billing")])]),t(f.A,{attrs:{cols:"6"}},[t(h.A,{attrs:{label:"Send Billing *",items:["Yes","No","Select"],outlined:"",dense:"",rules:[e=>!!e||"Send Billing is required"],required:""},model:{value:e.sendBillingLocal,callback:function(t){e.sendBillingLocal=t},expression:"sendBillingLocal"}})],1)],2),t(_.A,{staticClass:"my-6"}),t(c.A,{attrs:{color:"primary",block:"",large:"",type:"submit"}},[e._v(" Convert to Order ")])],1)],1)},I=[],S={name:"CreateOrderMBO",props:{lead:{type:Object,required:!0},sendBilling:{type:String,default:"Select"}},data(){return{isValid:!1,sendBillingLocal:this.sendBilling,form:{...this.lead,Bedrooms_Count:this.lead.Bedrooms_Count||1,Free_Rental:Boolean(this.lead.Free_Rental),Include_Bubble_Wrap:Boolean(this.lead.Include_Bubble_Wrap),Order_Subtotal:0,Base_Price:0,Additional_Week_Rate:0,Discount_Percentage:0,Bubble_Wrap_Price:0,Order_Total:0}}},computed:{totalBoxCount(){return 20*this.form.Bedrooms_Count},boxTier(){const e=this.totalBoxCount;return e<=20?1:e<=40?2:e<=60?3:e<=80?4:5},weeks(){if(!this.form.Rental_Start_Date||!this.form.Rental_End_Date)return 1;const e=new Date(this.form.Rental_Start_Date),t=new Date(this.form.Rental_End_Date),i=Math.ceil((t-e)/864e5);return Math.max(1,Math.ceil(i/7))},basePrice(){return{1:119,2:139,3:169,4:199,5:249}[this.boxTier]},additionalWeekRate(){return{1:50,2:65,3:80,4:95,5:110}[this.boxTier]},rentalCost(){return this.basePrice+(this.weeks-1)*this.additionalWeekRate},discountMultiplier(){return this.weeks>=8?.8:this.weeks>=4?.9:1},discountLabel(){return`${Math.round(100*(1-this.discountMultiplier))}%`},orderTotal(){const e=this.form.Include_Bubble_Wrap?60:0;return Math.round(this.rentalCost*this.discountMultiplier+e)},customOrderTotal(){const e=this.form.Include_Bubble_Wrap?60:0;return Number(this.form.Order_Subtotal||0)+e}},watch:{sendBillingLocal(e){this.$emit("update:sendBilling",e)}},methods:{handleSubmit(){if(!this.$refs.form.validate())return;const e=!0===this.form.Custom_Pricing;this.$emit("submit",{...this.form,Total_Box_Count:this.totalBoxCount,Box_Tier:e?null:this.boxTier,Weeks_Count:e?null:this.weeks,Order_Total:e?this.customOrderTotal:this.orderTotal,Send_Billing:this.sendBillingLocal,Lead_Type:"Moving Box Rental",Custom_Pricing:this.form.Custom_Pricing})}}},k=S,E=(0,B.A)(k,P,I,!1,null,"4b6ffa57",null),x=E.exports,T={name:"App",components:{createOrder:D,createOrderMBO:x},data(){return{leadId:null,leadData:null,leadLoaded:!1,leadType:null,universities:[],sendBilling:"Select",orderCreated:!1,createdOrderId:null,createdCustomerId:null}},computed:{isStudentStorageFormVisible(){return this.leadLoaded&&!this.orderCreated&&"Student Storage"===this.leadType},isMBRFormVisible(){return this.leadLoaded&&!this.orderCreated&&"Moving Box Rental"===this.leadType},isSupportedLeadType(){return["Student Storage","Moving Box Rental"].includes(this.leadType)}},mounted(){this.initializeZohoWidget()},methods:{initializeZohoWidget(){ZOHO.embeddedApp.on("PageLoad",this.handlePageLoad),ZOHO.embeddedApp.init()},async handlePageLoad(e){this.leadId=Array.isArray(e.EntityId)?e.EntityId[0]:e.EntityId;const t=await ZOHO.CRM.API.getRecord({Entity:"Leads",RecordID:this.leadId});this.leadData=t.data[0],this.leadType=this.leadData?.Lead_Type||null,this.leadLoaded=!0,await this.fetchUniversities()},async fetchUniversities(){const e=await ZOHO.CRM.API.getAllRecords({Entity:"Universities",page:1,per_page:200});this.universities=(e.data||[]).map(e=>({label:e.Name,value:e.id}))},async createOrderHandleSubmit(e){try{const t={leadId:this.leadId,leadType:this.leadType,send_billing:this.sendBilling,confirmedBy:this.leadData?.Owner?.id||null,confirmedAt:(new Date).toISOString(),orderDetails:e},i=await ZOHO.CRM.FUNCTIONS.execute("convertLeadtoCustomerOrder_Standalone",{arguments:JSON.stringify(t)}),r=JSON.parse(i.details.output);if("success"!==r.status)throw new Error(r.message);this.createdOrderId=r.orderId,this.createdCustomerId=r.customerId,this.orderCreated=!0,"Yes"===this.sendBilling&&("Student Storage"===this.leadType&&await this.createBillingSubscription(e),"Moving Box Rental"===this.leadType&&await this.createMBRBillingInvoice(e)),setTimeout(()=>{ZOHO.CRM.UI.Record.open({Entity:"Orders",RecordID:this.createdOrderId})},1e3)}catch(t){alert(t.message||"Order creation failed")}},async createOrderHandleSubmit(e){try{console.log("===== SUBMIT TRIGGERED ====="),console.log("Lead ID:",this.leadId),console.log("Lead Type:",this.leadType),console.log("Send Billing:",this.sendBilling),console.log("Order Details:",e);const t={leadId:this.leadId,leadType:this.leadType,send_billing:this.sendBilling,confirmedBy:this.leadData?.Owner?.id||null,confirmedAt:(new Date).toISOString(),orderDetails:e},i=await ZOHO.CRM.FUNCTIONS.execute("convertLeadtoCustomerOrder_Standalone",{arguments:JSON.stringify(t)});console.log("Order creation response:",i);const r=JSON.parse(i.details.output);if("success"!==r.status)throw new Error(r.message);this.createdOrderId=r.orderId,this.createdCustomerId=r.customerId,this.orderCreated=!0,console.log("Checking if billing should be created..."),"Yes"===this.sendBilling?("Student Storage"===this.leadType&&(console.log("Triggering createBillingSubscription..."),await this.createBillingSubscription(e)),"Moving Box Rental"===this.leadType&&(console.log("Triggering createMBRBillingInvoice..."),await this.createMBRBillingInvoice(e))):console.log("Billing not triggered (sendBilling != 'Yes')"),setTimeout(()=>{ZOHO.CRM.UI.Record.open({Entity:"Orders",RecordID:this.createdOrderId})},1e3)}catch(t){console.error("Order creation failed:",t),alert(t.message||"Order creation failed")}},async createBillingSubscription(e){try{console.log("===== createBillingSubscription CALLED ====="),console.log("Created Order ID:",this.createdOrderId),console.log("Created Customer ID:",this.createdCustomerId),console.log("Order Details Payload:",e);const t={order:{id:this.createdOrderId,customer_id:this.createdCustomerId,Number_of_bins:e.No_of_Bins||0,Number_of_loose_items:e.No_of_Loose_Items||0},orderDetails:e};console.log("Final billing payload sent to Zoho:",t);const i=await ZOHO.CRM.FUNCTIONS.execute("createZBillingSubscription",{arguments:JSON.stringify(t)});console.log("Billing function response:",i)}catch(t){console.error("Billing function error:",t)}},async createMBRBillingInvoice(e){const t={orderId:this.createdOrderId,orderDetails:e};await ZOHO.CRM.FUNCTIONS.execute("createZBillingInvoice",{arguments:JSON.stringify(t)})}}},R=T,M=(0,B.A)(R,n,d,!1,null,null,null),L=M.exports,N=i(5453);r.Ay.use(N.A);var $=new N.A({});r.Ay.config.productionTip=!1,new r.Ay({vuetify:$,render:e=>e(L)}).$mount("#app")}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,i),o.exports}i.m=e,function(){var e=[];i.O=function(t,r,s,o){if(!r){var l=1/0;for(c=0;c<e.length;c++){r=e[c][0],s=e[c][1],o=e[c][2];for(var a=!0,n=0;n<r.length;n++)(!1&o||l>=o)&&Object.keys(i.O).every(function(e){return i.O[e](r[n])})?r.splice(n--,1):(a=!1,o<l&&(l=o));if(a){e.splice(c--,1);var d=s();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[r,s,o]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,o,l=r[0],a=r[1],n=r[2],d=0;if(l.some(function(t){return 0!==e[t]})){for(s in a)i.o(a,s)&&(i.m[s]=a[s]);if(n)var c=n(i)}for(t&&t(r);d<l.length;d++)o=l[d],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(c)},r=self["webpackChunkzoho_app"]=self["webpackChunkzoho_app"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=i.O(void 0,[504],function(){return i(1831)});r=i.O(r)})();
//# sourceMappingURL=app.3f222eba.js.map